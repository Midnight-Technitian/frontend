<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/dashboard.css" rel="stylesheet">
    <link href="/css/ticket_dashboard.css" rel="stylesheet">
    <link href="/css/header.css" rel="stylesheet">
    <script type="text/javascript" src="/js/ServiceTicket.js"></script>
    <title>Employee Dashboard - Midnight Technician</title>
</head>
<body>
<div th:replace="~{fragments/header::header}"></div>

<!-- Header -->
<div class="dashboard-header">
    <div class="container">
        <div class="welcome-section">
            <h1 class="welcome-title">
                Welcome, <span th:text="${employee.firstName()}" class="customer-name">Technician</span>!
            </h1>
            <p class="welcome-subtitle">Manage and process service tickets efficiently</p>
        </div>
    </div>
</div>

<!-- Main Dashboard -->
<div class="container dashboard-container">

    <!-- Quick Overview -->
    <section class="quick-actions-section">
        <div class="actions-grid">
            <div class="action-card">
                <div class="action-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="none" stroke="currentColor"
                         stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M9 19V6l12-2v13"></path>
                        <circle cx="6" cy="19" r="2"></circle>
                        <circle cx="18" cy="21" r="2"></circle>
                    </svg>
                </div>
                <h3>Open Tickets</h3>
                <p th:text="${#lists.size(openTickets)} + ' tickets pending'">12 tickets pending</p>
            </div>

            <div class="action-card">
                <div class="action-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="none" stroke="currentColor"
                         stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <rect x="2" y="7" width="20" height="14" rx="2" ry="2"></rect>
                        <path d="M22 7V3H2v4"></path>
                    </svg>
                </div>
                <h3>Claimed Tickets</h3>
                <p th:text="${claimedTicketCount} + ' in progress'">5 in progress</p>
            </div>
        </div>
    </section>

    <!-- Ticket Management -->
    <section class="tickets-section">
        <div class="section-header">
            <h2 class="section-title">
                <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="none" stroke="currentColor"
                     stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M3 3h18v4H3zM3 11h18v4H3zM3 19h18v2H3z"></path>
                </svg>
                Ticket Management
            </h2>
            <div>
                <span class="ticket-count" th:text="${totalTickets} + ' total'">17 total</span>
            </div>
        </div>

        <div class="tickets-grid">
            <!-- Unclaimed Tickets -->
            <div th:each="ticket : ${unclaimedTickets}" class="ticket-card status-pending">
                <div class="ticket-header">
                    <span class="ticket-id" th:text="'#' + ${ticket.id}">#1245</span>
                    <span class="ticket-status">Unclaimed</span>
                </div>
                <h3 class="ticket-title" th:text="${ticket.title}">Printer not working</h3>
                <p class="ticket-description" th:text="${ticket.description}">Customer reports printer failure...</p>

                <div class="ticket-footer">
                    <span class="ticket-date">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" stroke="currentColor"
                             stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M3 4h18M5 2v4M19 2v4M4 10h16v10H4z"></path>
                        </svg>
                        <span th:text="${ticket.createdAt}">2025-10-25</span>
                    </span>
                    <button class="ticket-view-btn" th:onclick="'claimTicket(' + ${ticket.id} + ')'">Claim</button>
                </div>
            </div>

            <!-- Claimed Tickets -->
            <div th:each="ticket : ${claimedTickets}" class="ticket-card status-progress">
                <div class="ticket-header">
                    <span class="ticket-id" th:text="'#' + ${ticket.id}">#1250</span>
                    <span class="ticket-status">Claimed</span>
                </div>
                <h3 class="ticket-title" th:text="${ticket.title}">Network issue</h3>
                <p class="ticket-description" th:text="${ticket.description}">Investigating network dropouts...</p>

                <div class="ticket-footer">
                    <span class="ticket-date">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" stroke="currentColor"
                             stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M3 4h18M5 2v4M19 2v4M4 10h16v10H4z"></path>
                        </svg>
                        <span th:text="${ticket.updatedAt}">2025-10-25</span>
                    </span>
                    <button class="ticket-view-btn" th:onclick="'viewTicket(' + ${ticket.id} + ')'">View</button>
                </div>
            </div>
        </div>
    </section>

    <footer class="dashboard-footer">
        <p class="tagline"><em>Midnight Technician â€“ Supporting Excellence.</em></p>
    </footer>
</div>
</body>
</html>
